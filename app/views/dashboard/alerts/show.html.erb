<div class="space-y-6">
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <div class="flex items-center gap-2 mb-1">
        <%= link_to "Alerts", dashboard_project_alerts_path(@project), class: "text-[13px] dm-text-muted" %>
        <span class="dm-text-muted">/</span>
      </div>
      <h1 class="text-[24px] font-semibold dm-text"><%= @alert.alert_rule&.name || 'Alert' %></h1>
    </div>

    <% unless @alert.acknowledged %>
      <%= button_to "Acknowledge", acknowledge_dashboard_project_alert_path(@project, @alert), method: :post, class: "px-4 py-2 text-[13px] font-medium rounded-lg cursor-pointer transition-colors dm-btn-primary" %>
    <% end %>
  </div>

  <!-- Status -->
  <div class="flex items-center gap-4">
    <!-- State badge -->
    <% case @alert.state %>
    <% when 'firing' %>
      <span class="flex items-center gap-2 px-3 py-1.5 rounded-full dm-badge-error">
        <span class="w-2 h-2 rounded-full animate-pulse" style="background: var(--color-error-dot);"></span>
        <span class="text-[13px] font-medium">Firing</span>
      </span>
    <% when 'pending' %>
      <span class="flex items-center gap-2 px-3 py-1.5 rounded-full dm-badge-warning">
        <span class="w-2 h-2 rounded-full" style="background: var(--color-warning-orange-border);"></span>
        <span class="text-[13px] font-medium">Pending</span>
      </span>
    <% else %>
      <span class="flex items-center gap-2 px-3 py-1.5 rounded-full dm-badge-success">
        <span class="w-2 h-2 rounded-full" style="background: var(--color-success-dot);"></span>
        <span class="text-[13px] font-medium">Resolved</span>
      </span>
    <% end %>

    <!-- Severity -->
    <% case @alert.alert_rule&.severity %>
    <% when 'critical' %>
      <span class="px-3 py-1.5 text-[13px] font-medium rounded-full dm-badge-error">Critical</span>
    <% when 'warning' %>
      <span class="px-3 py-1.5 text-[13px] font-medium rounded-full dm-badge-warning">Warning</span>
    <% else %>
      <span class="px-3 py-1.5 text-[13px] font-medium rounded-full dm-badge-info">Info</span>
    <% end %>

    <% if @alert.acknowledged %>
      <span class="px-3 py-1.5 text-[13px] font-medium rounded-full dm-badge-success">
        Acknowledged by <%= @alert.acknowledged_by %>
      </span>
    <% end %>
  </div>

  <!-- Details -->
  <div class="grid grid-cols-2 gap-6">
    <div class="rounded-xl px-5 py-4 dm-card">
      <h3 class="text-[13px] font-medium mb-3 dm-text-muted">Alert Details</h3>
      <dl class="space-y-2">
        <div class="flex justify-between">
          <dt class="text-[13px] dm-text-placeholder">Current Value</dt>
          <dd class="text-[13px] font-medium dm-text"><%= @alert.current_value %></dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-[13px] dm-text-placeholder">Threshold</dt>
          <dd class="text-[13px] font-medium dm-text"><%= @alert.threshold_value %></dd>
        </div>
        <div class="flex justify-between">
          <dt class="text-[13px] dm-text-placeholder">Started</dt>
          <dd class="text-[13px] font-medium dm-text"><%= @alert.started_at&.strftime('%Y-%m-%d %H:%M:%S') %></dd>
        </div>
        <% if @alert.resolved_at %>
          <div class="flex justify-between">
            <dt class="text-[13px] dm-text-placeholder">Resolved</dt>
            <dd class="text-[13px] font-medium dm-text"><%= @alert.resolved_at.strftime('%Y-%m-%d %H:%M:%S') %></dd>
          </div>
        <% end %>
        <div class="flex justify-between">
          <dt class="text-[13px] dm-text-placeholder">Notifications Sent</dt>
          <dd class="text-[13px] font-medium dm-text"><%= @alert.notification_count %></dd>
        </div>
      </dl>
    </div>

    <div class="rounded-xl px-5 py-4 dm-card">
      <h3 class="text-[13px] font-medium mb-3 dm-text-muted">Rule Info</h3>
      <% if @alert.alert_rule %>
        <dl class="space-y-2">
          <div class="flex justify-between">
            <dt class="text-[13px] dm-text-placeholder">Source</dt>
            <dd class="text-[13px] font-medium dm-text"><%= @alert.alert_rule.source %></dd>
          </div>
          <div class="flex justify-between">
            <dt class="text-[13px] dm-text-placeholder">Type</dt>
            <dd class="text-[13px] font-medium dm-text"><%= @alert.alert_rule.rule_type %></dd>
          </div>
          <div class="flex justify-between">
            <dt class="text-[13px] dm-text-placeholder">Condition</dt>
            <dd class="text-[13px] font-medium dm-text"><%= @alert.alert_rule.operator %> <%= @alert.alert_rule.threshold %></dd>
          </div>
          <div class="flex justify-between">
            <dt class="text-[13px] dm-text-placeholder">Window</dt>
            <dd class="text-[13px] font-medium dm-text"><%= @alert.alert_rule.window %></dd>
          </div>
        </dl>
        <div class="mt-4 pt-3 border-t dm-border-light">
          <%= link_to "View Rule", dashboard_project_rule_path(@project, @alert.alert_rule), class: "text-[13px] font-medium", style: "color: var(--dm-brand);" %>
        </div>
      <% else %>
        <p class="text-[13px] dm-text-muted">Rule not found</p>
      <% end %>
    </div>
  </div>

  <!-- Labels -->
  <% if @alert.labels.present? %>
    <div class="rounded-xl px-5 py-4 dm-card">
      <h3 class="text-[13px] font-medium mb-3 dm-text-muted">Labels</h3>
      <div class="flex flex-wrap gap-2">
        <% @alert.labels.each do |key, value| %>
          <span class="px-2 py-1 text-[12px] rounded" style="background: var(--color-border-light); color: var(--color-text-subtle);">
            <%= key %>: <%= value %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Incident link -->
  <% if @alert.incident %>
    <div class="rounded-xl px-5 py-4 dm-card">
      <h3 class="text-[13px] font-medium mb-2 dm-text-muted">Related Incident</h3>
      <%= link_to dashboard_project_incident_path(@project, @alert.incident), class: "text-[14px] font-medium hover:underline", style: "color: var(--dm-brand);" do %>
        <%= @alert.incident.title %> (<%= @alert.incident.status %>)
      <% end %>
    </div>
  <% end %>
</div>
